/*!
 * jquery.stacky
 * Copyright (c) 2015 Miguel A. Jiménez - migueljimenezachinte<a>gmail<d>com | http://migueljimenez.co
 * Licensed under the MIT license.
 * https://github.com/jachinte/jquery.stacky
 * @projectDescription Stacky is a jQuery plugin that gives you the ability to open panels horizontally, as you need them.
 * @author Miguel A. Jiménez
 * @version v0.1.0
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";var b="Stacky";a[b]=function(b,c){var d={fadeInSpeed:"fast",scrollToSpeed:600,panelDefaults:{after:void 0,close:{show:!0,position:"right"},maximize:{show:!0,position:"right"},navigation:{left:[],right:[]},content:"",floating:!1,id:"",onBeforeOpen:function(){},onBeforeClose:function(){},size:"",title:""},texts:{close:"Close panel",collapse:"Collapse panel",expand:"Expand panel"}},e={active:"active",closeClickBound:"close-bound",close:"close",closeIcon:"pe-7s-close",collapseClickBound:"collapse-bound",collapse:"collapse",collapseIcon:"pe-7s-angle-down",content:"content",ellipsis:"ellipsis",expandClickBound:"expand-bound",expand:"expand",expandIcon:"pe-7s-angle-up",expanded:"expanded",floating:"floating",floatLeft:"left",floatRight:"right",panel:"panel",panels:"panels",shadowLeft:"shadow-left",shadowRight:"shadow-right"},f=this,g=a(b),b=b;f.settings={},f.panels=[],f.init=function(){f.settings=a.extend(!0,{},d,c),g.addClass(e.panels)},f.push=function(b){var c=a.extend(!0,{},f.settings.panelDefaults,b),d=h(c),i=g;if(d.addClass(e.active),d.css("display","none").css("z-index",""+(f.panels.length+1)),i.find("."+e.panel).removeClass(e.active),void 0===c.after||c.after.hasClass(e.floating))i.append(d),f.panels.push(d);else{c.after.after(d);var k=g.find("."+e.panel).index(c.after);f.panels.splice(k+1,0,d)}return i.not("."+e.closeClickBound).addClass(e.closeClickBound).on("click","."+e.close,{self:f,panelSettings:c},l),i.not("."+e.expandClickBound).addClass(e.expandClickBound).on("click","."+e.expand,{self:f},m),i.not("."+e.collapseClickBound).addClass(e.collapseClickBound).on("click","."+e.collapse,{self:f},n),c.onBeforeOpen&&"function"==typeof c.onBeforeOpen&&c.onBeforeOpen(d),d.fadeIn(f.settings.fadeInSpeed),i.animate({scrollLeft:j(d)},f.settings.scrollToSpeed),d};var h=function(b){var c="<div></div>",d=a("<section></section>").addClass(e.panel).addClass(b.size),h=a("<header></header>"),j=i(b),k=a(c).addClass(e.content),l=a("<article></article>"),m=a(c).addClass(e.shadowLeft),n=a(c).addClass(e.shadowRight);if(""!==b.content&&k.append(b.content),h.append(j).append(m.add(n)),""!==b.title){var o=a("<h1></h1>").addClass(e.ellipsis).text(b.title);h.append(o)}if(l.append(k),d.attr("id",b.id).append(h).append(l).append(m.add(n)),b.floating===!0){d.addClass(e.floating);var p=0;if(void 0!==b.after)for(var q=g.find("."+e.panel).index(b.after),r=0;r<f.panels.length&&q>=r;r++)p+=f.panels[r].outerWidth();d.css("left",p+"px")}return d},i=function(b){var c=a("<nav></nav>").addClass(e.floatLeft),d=a("<nav></nav>").addClass(e.floatRight);return b.maximize.show!==!0||b.floating!==!1||"left"!==b.maximize.position&&"right"!==b.maximize.position||b.navigation[b.maximize.position].push({link:"#!",alt:f.settings.texts.expand,linkClass:e.expand,iconClass:e.expandIcon+" big-icon"}),b.close.show!==!0||"left"!==b.close.position&&"right"!==b.close.position||b.navigation[b.close.position].push({link:"#!",alt:f.settings.texts.close,linkClass:e.close,iconClass:e.closeIcon+" big-icon"}),c.append(k(b.navigation.left)),d.append(k(b.navigation.right)),c.add(d)},j=function(a){for(var b=g.find("."+e.panel).index(a),c=0,d=0;d<f.panels.length&&b>=d;d++)c+=f.panels[d].outerWidth();return c},k=function(b){for(var c=a("<ul></ul>"),d=0;d<b.length;d++){var e=b[d],f=a("<i></i>").addClass(e.iconClass),g=a("<a></a>").attr("href",e.link).attr("title",e.alt).addClass(e.linkClass).append(f),h=a("<li></li>").append(g);c.append(h)}return c},l=function(b){var c=(b.data.self,b.data.panelSettings),d=a(this).closest("."+e.panel),h=d.hasClass(e.active),i=g.find("."+e.panel).index(d);return"function"==typeof c.onBeforeClose&&c.onBeforeClose(d)===!1?void b.preventDefault():(d.hide(),f.panels.splice(i,1),d.remove(),void(h&&g.find("."+e.panel).last().addClass(e.active)))},m=function(b){var c=b.data.self,d=a(this).closest("."+e.panel);a(this).removeClass(e.expand).addClass(e.collapse).attr("title",c.settings.texts.collapse),a(this).find("i").removeClass(e.expandIcon).addClass(e.collapseIcon),d.addClass(e.expanded),g.animate({scrollLeft:j(d)},c.settings.scrollToSpeed)},n=function(b){var c=b.data.self,d=a(this).closest("."+e.panel);a(this).removeClass(e.collapse).addClass(e.expand).attr("title",c.settings.texts.expand),a(this).find("i").removeClass(e.collapseIcon).addClass(e.expandIcon),d.removeClass(e.expanded),g.animate({scrollLeft:j(d)},c.settings.scrollToSpeed)};f.init()},a.fn[b]=function(c){return this.each(function(){if(void 0==a(this).data(b)){var d=new a[b](this,c);a(this).data(b,d)}})}});