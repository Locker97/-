/*
* jquery.stacky - v0.1.0 (2015-02-14)
* https://github.com/jachinte/jquery.stacky/
*
* Copyright (c) 2015 Miguel A. Jim√©nez - http://migueljimenez.co
* Licensed under the MIT license.
*/
!function(a,b,c,d){"use strict";var e="Stacky";a[e]=function(b,c){var e={fadeInSpeed:"fast",scrollToSpeed:600,panelDefaults:{after:d,close:{show:!0,position:"right"},maximize:{show:!0,position:"right"},navigation:{left:[],right:[]},content:"",floating:!1,id:"",onBeforeOpen:function(){},onBeforeClose:function(){},size:"",title:""},texts:{close:"Close panel",collapse:"Collapse panel",expand:"Expand panel"}},f={active:"active",closeClickBound:"close-bound",close:"close",closeIcon:"pe-7s-close",collapseClickBound:"collapse-bound",collapse:"collapse",collapseIcon:"pe-7s-angle-down",content:"content",ellipsis:"ellipsis",expandClickBound:"expand-bound",expand:"expand",expandIcon:"pe-7s-angle-up",expanded:"expanded",floating:"floating",floatLeft:"left",floatRight:"right",panel:"panel",shadowLeft:"shadow-left",shadowRight:"shadow-right"},g=this,h=a(b),b=b;g.settings={},g.panels=[],g.init=function(){g.settings=a.extend(!0,{},e,c)},g.push=function(b){var c=a.extend(!0,{},g.settings.panelDefaults,b),e=i(c),j=h;if(e.addClass(f.active),e.css("display","none").css("z-index",""+(g.panels.length+1)),j.find("."+f.panel).removeClass(f.active),c.after===d||c.after.hasClass(f.floating))j.append(e),g.panels.push(e);else{c.after.after(e);var l=h.find("."+f.panel).index(c.after);g.panels.splice(l+1,0,e)}return j.not("."+f.closeClickBound).addClass(f.closeClickBound).on("click","."+f.close,{self:g,panelSettings:c},m),j.not("."+f.expandClickBound).addClass(f.expandClickBound).on("click","."+f.expand,{self:g},n),j.not("."+f.collapseClickBound).addClass(f.collapseClickBound).on("click","."+f.collapse,{self:g},o),c.onBeforeOpen&&"function"==typeof c.onBeforeOpen&&c.onBeforeOpen(e),e.fadeIn(g.settings.fadeInSpeed),j.animate({scrollLeft:k(e)},g.settings.scrollToSpeed),e};var i=function(b){var c="<div></div>",e=a("<section></section>").addClass(f.panel).addClass(b.size),i=a("<header></header>"),k=j(b),l=a(c).addClass(f.content),m=a("<article></article>"),n=a(c).addClass(f.shadowLeft),o=a(c).addClass(f.shadowRight);if(""!==b.content&&l.append(b.content),i.append(k).append(n.add(o)),""!==b.title){var p=a("<h1></h1>").addClass(f.ellipsis).text(b.title);i.append(p)}if(m.append(l),e.attr("id",b.id).append(i).append(m).append(n.add(o)),b.floating===!0){e.addClass(f.floating);var q=0;if(b.after!==d)for(var r=h.find("."+f.panel).index(b.after),s=0;s<g.panels.length&&r>=s;s++)q+=g.panels[s].outerWidth();e.css("left",q+"px")}return e},j=function(b){var c=a("<nav></nav>").addClass(f.floatLeft),d=a("<nav></nav>").addClass(f.floatRight);return b.maximize.show!==!0||b.floating!==!1||"left"!==b.maximize.position&&"right"!==b.maximize.position||b.navigation[b.maximize.position].push({link:"#!",alt:g.settings.texts.expand,linkClass:f.expand,iconClass:f.expandIcon+" big-icon"}),b.close.show!==!0||"left"!==b.close.position&&"right"!==b.close.position||b.navigation[b.close.position].push({link:"#!",alt:g.settings.texts.close,linkClass:f.close,iconClass:f.closeIcon+" big-icon"}),c.append(l(b.navigation.left)),d.append(l(b.navigation.right)),c.add(d)},k=function(a){for(var b=h.find("."+f.panel).index(a),c=0,d=0;d<g.panels.length&&b>=d;d++)c+=g.panels[d].outerWidth();return c},l=function(b){for(var c=a("<ul></ul>"),d=0;d<b.length;d++){var e=b[d],f=a("<i></i>").addClass(e.iconClass),g=a("<a></a>").attr("href",e.link).attr("title",e.alt).addClass(e.linkClass).append(f),h=a("<li></li>").append(g);c.append(h)}return c},m=function(b){var c=(b.data.self,b.data.panelSettings),d=a(this).closest("."+f.panel),e=d.hasClass(f.active),i=h.find("."+f.panel).index(d);return"function"==typeof c.onBeforeClose&&c.onBeforeClose(d)===!1?void b.preventDefault():(d.hide(),g.panels.splice(i,1),d.remove(),void(e&&h.find("."+f.panel).last().addClass(f.active)))},n=function(b){var c=b.data.self,d=a(this).closest("."+f.panel);a(this).removeClass(f.expand).addClass(f.collapse).attr("title",c.settings.texts.collapse),a(this).find("i").removeClass(f.expandIcon).addClass(f.collapseIcon),d.addClass(f.expanded),h.animate({scrollLeft:k(d)},c.settings.scrollToSpeed)},o=function(b){var c=b.data.self,d=a(this).closest("."+f.panel);a(this).removeClass(f.collapse).addClass(f.expand).attr("title",c.settings.texts.expand),a(this).find("i").removeClass(f.collapseIcon).addClass(f.expandIcon),d.removeClass(f.expanded),h.animate({scrollLeft:k(d)},c.settings.scrollToSpeed)};g.init()},a.fn[e]=function(b){return this.each(function(){if(d==a(this).data(e)){var c=new a[e](this,b);a(this).data(e,c)}})}}(jQuery,window,document);